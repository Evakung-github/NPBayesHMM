<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen" />
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print" />
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>NPBayesHMM by michaelchughes</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>NPBayesHMM</h1>
          <h2>Nonparametric Bayesian Inference for Sequential Data.  Includes Beta process Hidden Markov Model (BP-HMM). Implemented in Matlab.</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/michaelchughes/NPBayesHMM/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/michaelchughes/NPBayesHMM/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/michaelchughes/NPBayesHMM" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h3>Welcome to the NPBayesHMM toolbox</h3>

<p>This is a Matlab toolbox for performing inference on <em>collections</em> of sequential data.  For example, you can analyze several motion capture sensor streams at once, or find common activities in a video corpus.</p>

<p>The basic model we employ is the Beta Process Hidden Markov Model (BP-HMM).  Briefly, this model assumes that each sequence is generated by a "hidden state sequence" (technically, an HMM), which indicates which of a global set of possible behaviors (think mocap exercises) is active at each time. Once we know the active behavior at time t, we generate the observed data at that step from its behavior's emission distribution. This model assumes exactly one behavior is active at each step.</p>

<p>Unlike the usual HMM approach, our BP-HMM is <em>nonparametric</em>.  This means that it does not require specifying in advance the exact number of behaviors used.  Instead, our inference explores possible sets of behaviors and finds an appropriate fit in a data-driven way.  This toolbox exists because these kinds of inference algorithms are quite complicated.  We've developed state-of-the-art methods to fit these models to real data, successfully analyzing hundreds of sequences at once.</p>

<p>For an academic introduction to the BP-HMM, see <a href="http://www.stat.washington.edu/%7Eebfox/publications/NIPS2009_BPARHMM.pdf">http://www.stat.washington.edu/~ebfox/publications/NIPS2009_BPARHMM.pdf</a>.</p>

<p>For technical information about our new and improved inference, see our NIPS 2012 paper: <a href="http://web.michaelchughes.com/research/bp-hmm-split-merge-inference">http://web.michaelchughes.com/research/bp-hmm-split-merge-inference</a></p>

<h3>Installation</h3>

<p>For complete details, check out <code>HOME/doc/QuickStartGuide.pdf</code></p>

<ol>
<li>Install required libraries

<ul>
<li><a href="http://eigen.tuxfamily.org/index.php?title=Main_Page">Eigen C++ Matrix Library</a></li>
<li><a href="http://research.microsoft.com/en-us/um/people/minka/software/lightspeed/">Tom Minka's Lightspeed for Matlab</a></li>
</ul>
</li>
<li>Compile MEX functions for fast HMM dynamic programming

<ul>
<li>See <code>HOME/code/CompileMEX.sh</code> for details</li>
</ul>
</li>
<li>Specify where you want saved results.

<ul>
<li>Create file <code>HOME/code/SimulationResults.path</code>
</li>
<li>Add one line of text that's a valid path on local system.</li>
</ul>
</li>
</ol><h3>Dive in!</h3>

<p>The best way to understand the toolbox is to check out the demos in <code>HOME/code/demo/</code>.  Here, we'll walk through the simplest, <code>EasyDemo.m</code>.</p>

<p>First, open Matlab and set up the working directory. Then just run the demo!</p>

<p><code>&gt;&gt; cd &lt;path/to/NPBayesHMM/HOME&gt;/code/</code></p>

<p><code>&gt;&gt; configNPBayesToolbox();  % adds paths appropriately</code></p>

<p><code>&gt;&gt; EasyDemo();</code></p>

<p>First, a collection of 5 data sequences are generated.  Here are two of them.  They are each 500 timesteps long, and at each timestep we observe a 2-dimensional vector (black and red lines).</p>

<p><img src="http://www.michaelchughes.com/blog/wp-content/uploads/2012/09/TrueData.png" alt="2 toy data sequences for the BP-HMM."></p>

<p>This data was generated by 4 hidden "behaviors" (also called features). The background color specifies which behavior is active at each timepoint. Each behavior specifies a 2D Gaussian distribution, which serve as the emission parameters when the HMM is actively in that state. In this toy example, these 4 behaviors have well-separated parameters, as seen in this contour plot.</p>

<p><img src="http://www.michaelchughes.com/blog/wp-content/uploads/2012/09/TrueTheta.png" alt="True Emission parameters."></p>

<p>We can build a binary matrix that indicates which sequences use which behaviors.  We call this matrix <code>F</code>, for "feature matrix".
<img src="http://www.michaelchughes.com/blog/wp-content/uploads/2012/09/TrueF-e1348844166319.png" alt="True Feature Matrix."></p>

<h3>Running MCMC</h3>

<p>After generating this data, we apply our posterior inference algorithm to learn the emission parameters theta and feature matrix F.  This demo performs 100 iterations of MCMC.  </p>

<p>The amazing thing out our nonparametric approach is that we <em>do not</em> need to specify the number of features... we can start the inference with just one feature and the algorithm will explore until it finds the best possible set of features.  You can see this in the stdout feed produced by the inference.</p>

<pre>
Initial Config: 
         0/100 after      0 sec | logPr -5.21e+03 | nFeats    1 
Running MCMC Sampler 1 : 1 ... 
         1/100 after      0 sec | logPr -3.97e+03 | nFeats    3 
        10/100 after      1 sec | logPr  2.71e+03 | nFeats    5 
        20/100 after      1 sec | logPr  2.72e+03 | nFeats    4 
        30/100 after      1 sec | logPr  2.72e+03 | nFeats    4 
        40/100 after      1 sec | logPr  2.72e+03 | nFeats    4 
        50/100 after      2 sec | logPr  2.72e+03 | nFeats    4 
        60/100 after      2 sec | logPr  2.72e+03 | nFeats    4 
        70/100 after      2 sec | logPr  2.72e+03 | nFeats    4 
        80/100 after      3 sec | logPr  2.72e+03 | nFeats    4 
        90/100 after      3 sec | logPr  2.72e+03 | nFeats    4 
       100/100 after      3 sec | logPr  2.72e+03 | nFeats    4 
</pre>

<p>Here's a look at the recovered Feature matrix:</p>

<p><img src="http://www.michaelchughes.com/blog/wp-content/uploads/2012/09/EstF.png" alt="Est Feature Matrix."></p>

<p>The recovered emission parameters theta:
<img src="http://www.michaelchughes.com/blog/wp-content/uploads/2012/09/EstTheta.png" alt="Est Theta."></p>

<p>Finally, the recovered state sequence for the two sequences we plotted earlier
<img src="http://www.michaelchughes.com/blog/wp-content/uploads/2012/09/EstZ.png" alt="Est State Sequence."></p>

<p>That's it! Hopefully this demo convinced you that (1) our inference works, and (2) the NPBayesHMM toolbox can be a productive tool for analyzing sequential data.</p>

<h3>More information</h3>

<p>Contact Mike Hughes via email: <code>mike &lt;AT&gt; michaelchughes.com</code></p>

<p>Read our NIPS 2012 paper (camera ready coming soon!)</p>

<h3>Related Projects</h3>

<p>Check out Matthew Johnson's HDP-HSMM project: <a href="http://mattjj.github.com/pyhsmm/">http://mattjj.github.com/pyhsmm/</a></p>

<p>Also, see Emily Fox's original BP-AR-HMM toolbox: <a href="http://www.stat.washington.edu/%7Eebfox/software.html">http://www.stat.washington.edu/~ebfox/software.html</a></p>
        </section>

        <footer>
          NPBayesHMM is maintained by <a href="https://github.com/michaelchughes">michaelchughes</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="http://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>